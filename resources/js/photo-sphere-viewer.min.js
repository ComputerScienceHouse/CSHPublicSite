/*!
 * Photo Sphere Viewer 3.1.0
 * Copyright (c) 2014-2015 Jérémy Heleine
 * Copyright (c) 2015-2016 Damien "Mistic" Sorel
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */

!function(a,b){"function"==typeof define&&define.amd?define(["three"],b):a.PhotoSphereViewer=b(a.THREE)}(this,function(a){"use strict";function b(a){if(!(this instanceof b))return new b(a);if(void 0===a||void 0===a.panorama||void 0===a.container)throw new o("no value given for panorama or container");if(this.config=p.deepmerge(b.DEFAULTS,a),this.config.min_fov=p.stayBetween(this.config.min_fov,1,179),this.config.max_fov=p.stayBetween(this.config.max_fov,1,179),this.config.tilt_up_max=p.stayBetween(this.config.tilt_up_max,-b.HalfPI,b.HalfPI),this.config.tilt_down_max=p.stayBetween(this.config.tilt_down_max,-b.HalfPI,b.HalfPI),null===this.config.default_fov?this.config.default_fov=this.config.max_fov:this.config.default_fov=p.stayBetween(this.config.default_fov,this.config.min_fov,this.config.max_fov),null===this.config.anim_lat&&(this.config.anim_lat=this.config.default_lat),this.config.anim_lat=p.stayBetween(this.config.anim_lat,-b.HalfPI,b.HalfPI),this.config.tilt_up_max<this.config.tilt_down_max)throw new o("tilt_up_max cannot be lower than tilt_down_max");this.config.caption&&!this.config.navbar&&(this.config.navbar="caption"),this.parent="string"==typeof this.config.container?document.getElementById(this.config.container):this.config.container,this.container=null,this.loader=null,this.navbar=null,this.hud=null,this.panel=null,this.tooltip=null,this.canvas_container=null,this.renderer=null,this.scene=null,this.camera=null,this.mesh=null,this.raycaster=null,this.actions={},this.prop={fps:60,latitude:0,longitude:0,anim_speed:0,zoom_lvl:0,moving:!1,zooming:!1,start_mouse_x:0,start_mouse_y:0,mouse_x:0,mouse_y:0,pinch_dist:0,direction:null,autorotate_timeout:null,animation_timeout:null,start_timeout:null,size:{width:0,height:0,ratio:0,image_width:0,image_height:0}},this.prop.zoom_lvl=Math.round((this.config.default_fov-this.config.min_fov)/(this.config.max_fov-this.config.min_fov)*100),this.prop.zoom_lvl-=2*(this.prop.zoom_lvl-50),this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),this.setAnimSpeed(this.config.anim_speed),this.rotate(this.config.default_long,this.config.default_lat),null!==this.config.size&&this._setViewerSize(this.config.size),this.config.autoload&&this.load()}function c(a){this.psv=a,this.container=null,this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(a){this.psv[a]=this[a].bind(this)},this)}function d(a){this.psv=a,this.container=null,this.canvas=null,this.create()}function e(a){c.call(this,a),this.markers={},this.currentMarker=null,this.create()}function f(a){c.call(this,a),this.content=null,this.prop={mouse_x:0,mouse_y:0,mousedown:!1,opened:!1},this.create()}function g(a){c.call(this,a),this.config=this.psv.config.tooltip,this.create()}function h(a){if(c.call(this,a),this.config=this.psv.config.navbar,this.caption=null,this.buttons=[],this.config===!0)this.config=p.clone(h.DEFAULTS);else if("string"==typeof this.config){var b={};Object.keys(h.DEFAULTS).forEach(function(a){b[a]=-1!==this.config.indexOf(a)},this),this.config=b}this.create()}function i(a){this.navbar=a,this.psv=a.psv,this.button=null}function j(a){i.call(this,a),this.create()}function k(a){i.call(this,a),this.create()}function l(a){i.call(this,a),this.zoom_range=null,this.zoom_value=null,this.prop={mousedown:!1},this.create()}function m(a){i.call(this,a),this.create()}function n(a){i.call(this,a),this.prop={panelOpened:!1,panelOpening:!1},this.create()}function o(a){this.message=a,"captureStackTrace"in Error?Error.captureStackTrace(this,o):this.stack=(new Error).stack}b.PI=Math.PI,b.TwoPI=2*Math.PI,b.HalfPI=Math.PI/2,b.MOVE_THRESHOLD=4,b.ICONS={},b.DEFAULTS={panorama:null,container:null,caption:null,autoload:!0,usexmpdata:!0,min_fov:30,max_fov:90,default_fov:null,default_long:0,default_lat:0,tilt_up_max:b.HalfPI,tilt_down_max:-b.HalfPI,long_offset:Math.PI/1440,lat_offset:Math.PI/720,time_anim:2e3,anim_speed:"2rpm",anim_lat:null,navbar:!1,tooltip:{offset:5,arrow_size:7},lang:{autorotate:"Automatic rotation",zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",download:"Download",fullscreen:"Fullscreen",markers:"Markers"},mousewheel:!0,mousemove:!0,loading_img:null,loading_txt:"Loading...",size:null,markers:[]},b.prototype.destroy=function(){window.removeEventListener("resize",this),document.removeEventListener(p.fullscreenEvent(),this),this.config.mousemove&&(this.hud.container.removeEventListener("mousedown",this),this.hud.container.removeEventListener("touchstart",this),window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this),this.hud.container.removeEventListener("mousemove",this),this.hud.container.removeEventListener("touchmove",this)),this.config.mousewheel&&this.hud.container.removeEventListener(p.mouseWheelEvent(),this),this.hud&&this.hud.destroy(),this.loader&&this.loader.destroy(),this.navbar&&this.navbar.destroy(),this.panel&&this.panel.destroy(),this.tooltip&&this.tooltip.destroy(),this.scene&&(this.scene.remove(this.camera),this.scene.remove(this.mesh)),this.mesh&&this.mesh.material&&(this.mesh.material.geometry&&this.mesh.material.geometry.dispose(),this.mesh.material.map&&this.mesh.material.map.dispose(),this.mesh.material.dispose()),this.canvas_container&&this.container.removeChild(this.canvas_container),this.parent.removeChild(this.container),this.container=null,this.loader=null,this.navbar=null,this.hud=null,this.panel=null,this.tooltip=null,this.canvas_container=null,this.renderer=null,this.scene=null,this.camera=null,this.mesh=null,this.raycaster=null,this.actions={}},b.prototype.load=function(){return this.container.classList.add("loading"),p.isCanvasSupported()?(this.loader=new d(this),this.canvas_container=document.createElement("div"),this.canvas_container.className="psv-canvas-container",this.container.appendChild(this.canvas_container),void(this.config.usexmpdata?this._loadXMP():this._loadTexture(!1,!1))):void(this.container.textContent="Canvas is not supported, update your browser!")},b.prototype._loadXMP=function(){if(!window.XMLHttpRequest)return void(this.container.textContent="XHR is not supported, update your browser!");var a=new XMLHttpRequest,b=this,c=0;a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status||201===a.status||202===a.status||0===a.status){b.loader.setProgress(100);var d=a.responseText,e=d.indexOf("<x:xmpmeta"),f=d.indexOf("</x:xmpmeta>"),g=d.substring(e,f);if(-1===e||-1===f||-1===g.indexOf("GPano:"))return void b._loadTexture(!1,!0);var h={full_width:parseInt(p.getXMPValue(g,"FullPanoWidthPixels")),full_height:parseInt(p.getXMPValue(g,"FullPanoHeightPixels")),cropped_width:parseInt(p.getXMPValue(g,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(p.getXMPValue(g,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(p.getXMPValue(g,"CroppedAreaLeftPixels")),cropped_y:parseInt(p.getXMPValue(g,"CroppedAreaTopPixels"))};b._loadTexture(h,!0)}else b.container.textContent="Cannot load image";else 3===a.readyState&&b.loader.setProgress(c+10)},a.onprogress=function(a){if(a.lengthComputable){var d=parseInt(a.loaded/a.total*100);d>c&&(c=d,b.loader.setProgress(c))}},a.onerror=function(){b.container.textContent="Cannot load image"},a.open("GET",this.config.panorama,!0),a.send(null)},b.prototype._loadTexture=function(b,c){var d=new a.ImageLoader,e=this,f=c?100:0;this.config.panorama.match(/^data:image\/[a-z]+;base64/)||d.setCrossOrigin("anonymous");var g=function(a){e.loader.setProgress(100),b||(b={full_width:a.width,full_height:a.height,cropped_width:a.width,cropped_height:a.height,cropped_x:0,cropped_y:0});var c=4096;p.isWebGLSupported()&&(c=p.getMaxTextureWidth());var d=Math.min(b.full_width,c),f=d/b.full_width;b.full_width*=f,b.full_height*=f,b.cropped_width*=f,b.cropped_height*=f,b.cropped_x*=f,b.cropped_y*=f,a.width=b.cropped_width,a.height=b.cropped_height;var g=document.createElement("canvas");g.width=b.full_width,g.height=b.full_height;var h=g.getContext("2d");h.drawImage(a,b.cropped_x,b.cropped_y,b.cropped_width,b.cropped_height),e.prop.size.image_width=b.cropped_width,e.prop.size.image_height=b.cropped_height,e._createScene(g)},h=function(a){if(a.lengthComputable){var b=parseInt(a.loaded/a.total*100);b>f&&(f=b,e.loader.setProgress(f))}},i=function(){e.container.textContent="Cannot load image"};d.load(this.config.panorama,g,h,i)},b.prototype._createScene=function(c){this._onResize(),this.raycaster=new a.Raycaster,this.renderer=p.isWebGLSupported()?new a.WebGLRenderer:new a.CanvasRenderer,this.renderer.setSize(this.prop.size.width,this.prop.size.height),this.camera=new a.PerspectiveCamera(this.config.default_fov,this.prop.size.ratio,1,300),this.camera.position.set(0,0,0),this.scene=new a.Scene,this.scene.add(this.camera);var d=new a.Texture(c);d.needsUpdate=!0;var i=new a.SphereGeometry(200,32,32,-b.HalfPI),j=new a.MeshBasicMaterial({map:d,overdraw:!0});j.side=a.DoubleSide,this.mesh=new a.Mesh(i,j),this.mesh.scale.x=-1,this.scene.add(this.mesh),this.canvas_container.appendChild(this.renderer.domElement),this.loader.destroy(),this.loader=null,this.container.classList.remove("loading"),this.config.navbar&&(this.container.classList.add("has-navbar"),this.navbar=new h(this)),this.hud=new e(this),this.config.markers.forEach(function(a){this.hud.addMarker(a,!1)},this),this.panel=new f(this),this.tooltip=new g(this),this.config.time_anim!==!1&&(this.prop.start_timeout=setTimeout(this.startAutorotate.bind(this),this.config.time_anim)),this._bindEvents(),this.trigger("ready"),this.render()},b.prototype._bindEvents=function(){window.addEventListener("resize",this),document.addEventListener(p.fullscreenEvent(),this),this.config.mousemove&&(this.hud.container.style.cursor="move",this.hud.container.addEventListener("mousedown",this),this.hud.container.addEventListener("touchstart",this),window.addEventListener("mouseup",this),window.addEventListener("touchend",this),this.hud.container.addEventListener("mousemove",this),this.hud.container.addEventListener("touchmove",this)),this.config.mousewheel&&this.hud.container.addEventListener(p.mouseWheelEvent(),this)},b.prototype.handleEvent=function(a){switch(a.type){case"resize":this._onResize();break;case"mousedown":this._onMouseDown(a);break;case"touchstart":this._onTouchStart(a);break;case"mouseup":this._onMouseUp(a);break;case"touchend":this._onTouchEnd(a);break;case"mousemove":this._onMouseMove(a);break;case"touchmove":this._onTouchMove(a);break;case p.fullscreenEvent():this._fullscreenToggled();break;case p.mouseWheelEvent():this._onMouseWheel(a)}},b.prototype.render=function(){this.prop.direction=new a.Vector3(-Math.cos(this.prop.latitude)*Math.sin(this.prop.longitude),Math.sin(this.prop.latitude),Math.cos(this.prop.latitude)*Math.cos(this.prop.longitude)),this.camera.lookAt(this.prop.direction),this.renderer.render(this.scene,this.camera),this.trigger("render")},b.prototype._autorotate=function(){this.rotate(this.prop.longitude+this.prop.anim_speed/this.prop.fps,this.prop.latitude-(this.prop.latitude-this.config.anim_lat)/200),this.prop.autorotate_timeout=setTimeout(this._autorotate.bind(this),1e3/this.prop.fps)},b.prototype.startAutorotate=function(){clearTimeout(this.prop.start_timeout),this.prop.start_timeout=null,this.stopAnimation(),this._autorotate(),this.trigger("autorotate",!0)},b.prototype.stopAutorotate=function(){clearTimeout(this.prop.start_timeout),this.prop.start_timeout=null,clearTimeout(this.prop.autorotate_timeout),this.prop.autorotate_timeout=null,this.trigger("autorotate",!1)},b.prototype.toggleAutorotate=function(){this.prop.autorotate_timeout?this.stopAutorotate():this.startAutorotate()},b.prototype._onResize=function(){(this.container.clientWidth!=this.prop.size.width||this.container.clientHeight!=this.prop.size.height)&&this.resize(this.container.clientWidth,this.container.clientHeight)},b.prototype.resize=function(a,b){this.prop.size.width=parseInt(a),this.prop.size.height=parseInt(b),this.prop.size.ratio=this.prop.size.width/this.prop.size.height,this.camera&&(this.camera.aspect=this.prop.size.ratio,this.camera.updateProjectionMatrix()),this.renderer&&(this.renderer.setSize(this.prop.size.width,this.prop.size.height),this.render()),this.trigger("size-updated",this.prop.size.width,this.prop.size.height)},b.prototype._onMouseDown=function(a){this._startMove(a)},b.prototype._onTouchStart=function(a){1===a.touches.length?this._startMove(a.touches[0]):2===a.touches.length&&this._startZoom(a)},b.prototype._startMove=function(a){this.prop.mouse_x=this.prop.start_mouse_x=parseInt(a.clientX),this.prop.mouse_y=this.prop.start_mouse_y=parseInt(a.clientY),this.prop.moving=!0,this.prop.moved=!1,this.prop.zooming=!1,this.stopAutorotate(),this.stopAnimation()},b.prototype._startZoom=function(a){var b=[{x:parseInt(a.touches[0].clientX),y:parseInt(a.touches[0].clientY)},{x:parseInt(a.touches[1].clientX),y:parseInt(a.touches[1].clientY)}];this.prop.pinch_dist=Math.sqrt(Math.pow(b[0].x-b[1].x,2)+Math.pow(b[0].y-b[1].y,2)),this.prop.moving=!1,this.prop.zooming=!0,this.stopAutorotate(),this.stopAnimation()},b.prototype._onMouseUp=function(a){this._stopMove(a)},b.prototype._onTouchEnd=function(a){this._stopMove(a.changedTouches[0])},b.prototype._stopMove=function(a){this.prop.moving&&(Math.abs(a.clientX-this.prop.start_mouse_x)<b.MOVE_THRESHOLD&&Math.abs(a.clientY-this.prop.start_mouse_y)<b.MOVE_THRESHOLD?this._click(a):this.prop.moved=!0),this.prop.moving=!1,this.prop.zooming=!1},b.prototype._click=function(c){if(this.trigger("_click",c),!c.defaultPrevented){var d=this.container.getBoundingClientRect(),e={client_x:parseInt(c.clientX-d.left),client_y:parseInt(c.clientY-d.top)},f=new a.Vector2(2*e.client_x/this.prop.size.width-1,-2*e.client_y/this.prop.size.height+1);this.raycaster.setFromCamera(f,this.camera);var g=this.raycaster.intersectObjects(this.scene.children);if(1===g.length){var h=g[0].point,i=Math.acos(h.y/Math.sqrt(h.x*h.x+h.y*h.y+h.z*h.z)),j=Math.atan2(h.x,h.z);e.longitude=0>j?-j:b.TwoPI-j,e.latitude=b.HalfPI-i;var k=e.longitude/b.TwoPI*this.prop.size.image_width,l=e.latitude/b.PI*this.prop.size.image_height;e.texture_x=parseInt(e.longitude<b.PI?k+this.prop.size.image_width/2:k-this.prop.size.image_width/2),e.texture_y=parseInt(this.prop.size.image_height/2-l),this.trigger("click",e)}}},b.prototype._onMouseMove=function(a){a.preventDefault(),this._move(a)},b.prototype._onTouchMove=function(a){1===a.touches.length?(a.preventDefault(),this._move(a.touches[0])):2===a.touches.length&&(a.preventDefault(),this._zoom(a))},b.prototype._move=function(a){if(this.prop.moving){var b=parseInt(a.clientX),c=parseInt(a.clientY);this.rotate(this.prop.longitude-(b-this.prop.mouse_x)*this.config.long_offset,this.prop.latitude+(c-this.prop.mouse_y)*this.config.lat_offset),this.prop.mouse_x=b,this.prop.mouse_y=c}},b.prototype._zoom=function(a){if(this.prop.zooming){var b=[{x:parseInt(a.touches[0].clientX),y:parseInt(a.touches[0].clientY)},{x:parseInt(a.touches[1].clientX),y:parseInt(a.touches[1].clientY)}],c=Math.sqrt(Math.pow(b[0].x-b[1].x,2)+Math.pow(b[0].y-b[1].y,2)),d=80*(c-this.prop.pinch_dist)/this.prop.size.width;this.zoom(this.prop.zoom_lvl+d),this.prop.pinch_dist=c}},b.prototype.rotate=function(a,c){this.prop.longitude=a-Math.floor(a/b.TwoPI)*b.TwoPI,this.prop.latitude=p.stayBetween(c,this.config.tilt_down_max,this.config.tilt_up_max),this.renderer&&this.render(),this.trigger("position-updated",this.prop.longitude,this.prop.latitude)},b.prototype.animate=function(a,c,d){if(!d)return void this.rotate(a,c);a-=Math.floor(a/b.TwoPI)*b.TwoPI,c=p.stayBetween(c,this.config.tilt_down_max,this.config.tilt_up_max);var e,f=this.prop.longitude,g=this.prop.latitude;if(d&&"number"==typeof d)e=d/1e3;else{var h=d?this._parseAnimSpeed(d):this.prop.anim_speed,i=Math.acos(Math.cos(g)*Math.cos(c)*Math.cos(f-a)+Math.sin(g)*Math.sin(c));e=i/h}var j=e*this.prop.fps,k=[a-f,b.TwoPI-f+a,a-f-b.TwoPI],l=k.reduce(function(a,b){return Math.abs(b)<Math.abs(a)?b:a},1/0),m=c-g;this.stopAutorotate(),this.stopAnimation(),this._animate(l/j,m/j,a,c)},b.prototype._animate=function(a,b,c,d){0!==a&&Math.abs(this.prop.longitude-c)<=2*Math.abs(a)&&(a=0,this.prop.longitude=c),0!==b&&Math.abs(this.prop.latitude-d)<=2*Math.abs(b)&&(b=0,this.prop.latitude=d),this.rotate(this.prop.longitude+a,this.prop.latitude+b),0!==a||0!==b?this.prop.animation_timeout=setTimeout(this._animate.bind(this,a,b,c,d),1e3/this.prop.fps):this.stopAnimation()},b.prototype.stopAnimation=function(){clearTimeout(this.prop.animation_timeout),this.prop.animation_timeout=null},b.prototype._onMouseWheel=function(a){a.preventDefault(),a.stopPropagation();var b=void 0!==a.deltaY?-a.deltaY:void 0!==a.wheelDelta?a.wheelDelta:-a.detail;if(0!==b){var c=parseInt(b/Math.abs(b));this.zoom(this.prop.zoom_lvl+c)}},b.prototype.zoom=function(a){this.prop.zoom_lvl=p.stayBetween(parseInt(Math.round(a)),0,100),this.camera.fov=this.config.max_fov+this.prop.zoom_lvl/100*(this.config.min_fov-this.config.max_fov),this.camera.updateProjectionMatrix(),this.render(),this.trigger("zoom-updated",this.prop.zoom_lvl)},b.prototype.zoomIn=function(){this.prop.zoom_lvl<100&&this.zoom(this.prop.zoom_lvl+1)},b.prototype.zoomOut=function(){this.prop.zoom_lvl>0&&this.zoom(this.prop.zoom_lvl-1)},b.prototype._fullscreenToggled=function(){this.trigger("fullscreen-updated",p.isFullscreenEnabled())},b.prototype.toggleFullscreen=function(){p.isFullscreenEnabled()?p.exitFullscreen():p.requestFullscreen(this.container)},b.prototype._parseAnimSpeed=function(a){a=a.toString().trim();var c=parseFloat(a.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),d=a.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();d.match(/(pm|per minute)$/)&&(c/=60);var e=0;switch(d){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=c*Math.PI/180;break;case"radians per minute":case"radians per second":e=c;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=c*b.TwoPI;break;default:throw new o('unknown speed unit "'+d+'"')}return e},b.prototype.setAnimSpeed=function(a){this.prop.anim_speed=this._parseAnimSpeed(a)},b.prototype._setViewerSize=function(a){["width","height"].forEach(function(b){a[b]&&(/^[0-9.]+$/.test(a[b])&&(a[b]+="px"),this.parent.style[b]=a[b])},this)},b.prototype.on=function(a,b){a in this.actions||(this.actions[a]=[]),this.actions[a].push(b)},b.prototype.off=function(a,b){if(a in this.actions){var c=this.actions[a].indexOf(b);-1!==c&&this.actions[a].splice(c,1)}},b.prototype.trigger=function(a,b){b=Array.prototype.slice.call(arguments,1),a in this.actions&&this.actions[a].length>0&&this.actions[a].forEach(function(c){"object"==typeof c?c.handleEvent({type:"psv:"+a,args:b}):c.apply(this,b)},this)},c.prototype.create=function(){this.container=document.createElement("div"),this.psv.container.appendChild(this.container)},c.prototype.destroy=function(){this.psv.container.removeChild(this.container),this.container=null,this.psv=null},d.prototype.create=function(){this.container=document.createElement("div"),this.container.className="psv-loader",this.psv.container.appendChild(this.container),this.canvas=document.createElement("canvas"),this.canvas.className="loader-canvas",this.canvas.width=this.container.clientWidth,this.canvas.height=this.container.clientWidth,this.container.appendChild(this.canvas),this.tickness=(this.container.offsetWidth-this.container.clientWidth)/2;var a;if(this.psv.config.loading_img?(a=document.createElement("img"),a.className="loader-image",a.src=this.psv.config.loading_img):this.psv.config.loading_txt&&(a=document.createElement("div"),a.className="loader-text",a.innerHTML=this.psv.config.loading_txt),a){var b=Math.round(Math.sqrt(2*Math.pow(this.canvas.width/2-this.tickness/2,2)));a.style.maxWidth=b+"px",a.style.maxHeight=b+"px",this.container.appendChild(a)}},d.prototype.destroy=function(){this.psv.container.removeChild(this.container),this.psv=null,this.container=null},d.prototype.setProgress=function(a){var b=this.canvas.getContext("2d");b.clearRect(0,0,this.canvas.width,this.canvas.height),b.lineWidth=this.tickness,b.strokeStyle=p.getStyle(this.container,"color"),b.beginPath(),b.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2-this.tickness/2,-Math.PI/2,a/100*2*Math.PI-Math.PI/2),b.stroke()},e.prototype=Object.create(c.prototype),e.prototype.constructor=e,e.publicMethods=["addMarker","removeMarker","updateMarker","getMarker","getCurrentMarker","gotoMarker","hideMarker","showMarker","toggleMarker"],e.prototype.create=function(){c.prototype.create.call(this),this.container.className="psv-hud",this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.psv.on("_click",this),this.psv.on("render",this)},e.prototype.destroy=function(){this.container.removeEventListener("mouseenter",this),this.container.removeEventListener("mouseleave",this),this.psv.off("_click",this),this.psv.off("render",this),c.prototype.destroy.call(this)},e.prototype.handleEvent=function(a){switch(a.type){case"mouseenter":this._onMouseEnter(a);break;case"mouseleave":this._onMouseLeave(a);break;case"psv:_click":this._onClick(a.args[0]);break;case"psv:render":this.updatePositions()}},e.prototype.addMarker=function(a,b){if(!a.id)throw new o("missing marker id");if(this.markers[a.id])throw new o('marker "'+a.id+'" already exists');if(!a.image&&!a.html)throw new o("missing marker image/html");if(a.image&&(!a.width||!a.height))throw new o("missing marker width/height");if(!(a.hasOwnProperty("x")&&a.hasOwnProperty("y")||a.hasOwnProperty("latitude")&&a.hasOwnProperty("longitude")))throw new o("missing marker position, latitude/longitude or x/y");return a.$el=document.createElement("div"),a.$el.id="psv-marker-"+a.id,a.$el.className="psv-marker",this.markers[a.id]=a,this.container.appendChild(a.$el),this.updateMarker(p.clone(a),b)},e.prototype.getMarker=function(a){var b="object"==typeof a?a.id:a;if(!this.markers[b])throw new o('cannot find marker "'+b+'"');return this.markers[b]},e.prototype.getCurrentMarker=function(){return this.currentMarker},e.prototype.updateMarker=function(c,d){var e=this.getMarker(c);e.className&&e.$el.classList.remove(e.className),e.tooltip&&e.$el.classList.remove("has-tooltip"),delete c.$el,c=p.deepmerge(e,c),c.position2D=null,c.className&&c.$el.classList.add(c.className),c.tooltip&&(c.$el.classList.add("has-tooltip"),"string"==typeof c.tooltip&&(c.tooltip={content:c.tooltip}));var f=c.$el.style;if(c.width&&c.height?(f.width=c.width+"px",f.height=c.height+"px",c.dynamicSize=!1):c.dynamicSize=!0,c.style&&Object.getOwnPropertyNames(c.style).forEach(function(a){f[a]=c.style[a]}),c.image?f.backgroundImage="url("+c.image+")":c.$el.innerHTML=c.html,c.anchor=p.parsePosition(c.anchor),c.hasOwnProperty("x")&&c.hasOwnProperty("y")){var g=c.x/this.psv.prop.size.image_width*b.TwoPI,h=c.y/this.psv.prop.size.image_height*b.PI;c.longitude=g>=b.PI?g-b.PI:g+b.PI,c.latitude=b.HalfPI-h}return c.position3D=new a.Vector3(-Math.cos(c.latitude)*Math.sin(c.longitude),Math.sin(c.latitude),Math.cos(c.latitude)*Math.cos(c.longitude)),c.hasOwnProperty("visible")||(c.visible=!0),c.$el.psvMarker=c,this.markers[c.id]=c,d!==!1&&this.updatePositions(),c},e.prototype.removeMarker=function(a,b){a=this.getMarker(a),a.$el.parentNode.removeChild(a.$el),delete this.markers[a.id],b!==!1&&this.updatePositions()},e.prototype.gotoMarker=function(a,b){a=this.getMarker(a),this.psv.animate(a.longitude,a.latitude,b)},e.prototype.hideMarker=function(a){this.getMarker(a).visible=!1,this.updatePositions()},e.prototype.showMarker=function(a){this.getMarker(a).visible=!0,this.updatePositions()},e.prototype.toggleMarker=function(a){this.getMarker(a).visible^=!0,this.updatePositions()},e.prototype.updatePositions=function(){this.psv.camera.updateProjectionMatrix();for(var a in this.markers){var b=this.markers[a],c=this._getMarkerPosition(b);this._isMarkerVisible(b,c)?(b.position2D=c,b.$el.style.transform="translate3D("+c.left+"px, "+c.top+"px, 0px)",b.$el.classList.contains("visible")||b.$el.classList.add("visible")):(b.position2D=null,b.$el.classList.remove("visible"))}},e.prototype._isMarkerVisible=function(a,b){return a.visible&&a.position3D.dot(this.psv.prop.direction)>0&&b.left+a.width>=0&&b.left-a.width<=this.psv.prop.size.width&&b.top+a.height>=0&&b.top-a.height<=this.psv.prop.size.height},e.prototype._getMarkerPosition=function(a){if(a.dynamicSize){a.$el.classList.add("transparent");var b=a.$el.getBoundingClientRect();a.$el.classList.remove("transparent"),a.width=b.right-b.left,a.height=b.bottom-b.top}var c=a.position3D.clone();return c.project(this.psv.camera),{top:(1-c.y)/2*this.psv.prop.size.height-a.height*a.anchor.top,left:(c.x+1)/2*this.psv.prop.size.width-a.width*a.anchor.left}},e.prototype._onMouseEnter=function(a){if(a.target&&a.target.psvMarker&&a.target.psvMarker.tooltip){var b=a.target.psvMarker;this.psv.tooltip.showTooltip({content:b.tooltip.content,position:b.tooltip.position,top:b.position2D.top,left:b.position2D.left,marker:b})}},e.prototype._onMouseLeave=function(a){a.target&&a.target.psvMarker&&this.psv.tooltip.hideTooltip()},e.prototype._onClick=function(a){if(!this.psv.prop.moved){var b;a.target&&(b=p.getClosest(a.target,".psv-marker"))&&b.psvMarker?(this.currentMarker=b.psvMarker,this.psv.trigger("select-marker",b.psvMarker),a.preventDefault()):this.currentMarker&&(this.currentMarker=null,this.psv.trigger("unselect-marker")),b&&b.psvMarker&&b.psvMarker.content?this.psv.panel.showPanel(b.psvMarker.content):this.psv.panel.prop.opened&&(a.preventDefault(),this.psv.panel.hidePanel())}},f.prototype=Object.create(c.prototype),f.prototype.constructor=f,f.publicMethods=["showPanel","hidePanel"],f.prototype.create=function(){c.prototype.create.call(this),this.container.className="psv-panel",this.container.innerHTML='<div class="resizer"></div><div class="close-button"></div><div class="content"></div>',this.content=this.container.querySelector(".content");var a=this.container.querySelector(".close-button");a.addEventListener("click",this.hidePanel.bind(this)),this.psv.config.mousewheel&&this.container.addEventListener(p.mouseWheelEvent(),function(a){a.stopPropagation()});var b=this.container.querySelector(".resizer");b.addEventListener("mousedown",this),b.addEventListener("touchstart",this),this.psv.container.addEventListener("mouseup",this),this.psv.container.addEventListener("touchend",this),this.psv.container.addEventListener("mousemove",this),this.psv.container.addEventListener("touchmove",this)},f.prototype.destroy=function(){this.psv.container.removeEventListener("mousemove",this),this.psv.container.removeEventListener("touchmove",this),this.psv.container.removeEventListener("mouseup",this),this.psv.container.removeEventListener("touchend",this),c.prototype.destroy.call(this)},f.prototype.handleEvent=function(a){switch(a.type){case"mousedown":this._onMouseDown(a);break;case"touchstart":this._onTouchStart(a);break;case"mousemove":this._onMouseMove(a);break;case"touchmove":this._onMouseMove(a);break;case"mouseup":this._onMouseUp(a);break;case"touchend":this._onMouseUp(a)}},f.prototype.showPanel=function(a,b){this.content.innerHTML=a,this.content.scrollTop=0,this.container.classList.add("open"),b?this.content.classList.contains("no-margin")||this.content.classList.add("no-margin"):this.content.classList.remove("no-margin"),this.prop.opened=!0,this.psv.trigger("open-panel")},f.prototype.hidePanel=function(){this.prop.opened=!1,this.container.classList.remove("open"),this.psv.trigger("close-panel")},f.prototype._onMouseDown=function(a){a.stopPropagation(),this._startResize(a)},f.prototype._onTouchStart=function(a){a.stopPropagation(),this._startResize(a.changedTouches[0])},f.prototype._startResize=function(a){this.prop.mouse_x=parseInt(a.clientX),this.prop.mouse_y=parseInt(a.clientY),this.prop.mousedown=!0,this.content.classList.add("no-interaction")},f.prototype._onMouseUp=function(a){this.prop.mousedown&&(a.stopPropagation(),this.prop.mousedown=!1,this.content.classList.remove("no-interaction"))},f.prototype._onMouseMove=function(a){this.prop.mousedown&&(a.stopPropagation(),this._resize(a))},f.prototype._onTouchMove=function(a){this.prop.mousedown&&(a.stopPropagation(),this._resize(a.changedTouches[0]))},f.prototype._resize=function(a){var b=parseInt(a.clientX),c=parseInt(a.clientY);this.container.style.width=this.container.offsetWidth-(b-this.prop.mouse_x)+"px",this.prop.mouse_x=b,this.prop.mouse_y=c},g.prototype=Object.create(c.prototype),g.prototype.constructor=g,g.publicMethods=["showTooltip","hideTooltip"],g.leftMap={0:"left",.5:"center",1:"right"},g.topMap={0:"top",.5:"center",1:"bottom"},g.prototype.create=function(){c.prototype.create.call(this),this.container.innerHTML='<div class="arrow"></div><div class="content"></div>',this.container.className="psv-tooltip",this.container.style.top="-1000px",this.container.style.left="-1000px",this.psv.on("render",this)},g.prototype.destroy=function(){this.psv.off("render",this),c.prototype.destroy.call(this)},g.prototype.handleEvent=function(a){switch(a.type){case"psv:render":this.hideTooltip()}},g.prototype.showTooltip=function(a){var b=this.container,c=b.querySelector(".content"),d=b.querySelector(".arrow");if(a.position||(a.position=["top","center"]),a.marker||(a.marker={width:0,height:0}),"string"==typeof a.position){var e=p.parsePosition(a.position);if(!(e.left in g.leftMap&&e.top in g.topMap))throw new o('unable to parse tooltip position "'+tooltip.position+'"');a.position=[g.topMap[e.top],g.leftMap[e.left]]}if("center"==a.position[0]&&"center"==a.position[1])throw new o('unable to parse tooltip position "center center"');b.className="psv-tooltip",a.className&&b.classList.add(a.className),c.innerHTML=a.content,b.style.top="0px",b.style.left="0px";var f=b.getBoundingClientRect(),h={posClass:a.position.slice(),width:f.right-f.left,height:f.bottom-f.top,top:0,left:0,arrow_top:0,arrow_left:0};this._computeTooltipPosition(h,a);var i=!1;h.top<this.config.offset?(h.posClass[0]="bottom",i=!0):h.top+h.height>this.psv.prop.size.height-this.config.offset&&(h.posClass[0]="top",i=!0),h.left<this.config.offset?(h.posClass[1]="right",i=!0):h.left+h.width>this.psv.prop.size.width-this.config.offset&&(h.posClass[1]="left",i=!0),i&&this._computeTooltipPosition(h,a),b.style.top=h.top+"px",b.style.left=h.left+"px",d.style.top=h.arrow_top+"px",d.style.left=h.arrow_left+"px",b.classList.add(h.posClass.join("-"));var j=this;setTimeout(function(){b.classList.add("visible"),j.psv.trigger("show-tooltip")},100)},g.prototype.hideTooltip=function(){this.container.classList.remove("visible"),this.psv.trigger("hide-tooltip");var a=this;setTimeout(function(){a.container.style.top="-1000px",a.container.style.left="-1000px"},100)},g.prototype._computeTooltipPosition=function(a,b){var c=!1;switch(a.posClass[0]){case"bottom":a.top=b.top+b.marker.height+this.config.offset+this.config.arrow_size,a.arrow_top=2*-this.config.arrow_size,c=!0;break;case"center":a.top=b.top+b.marker.height/2-a.height/2,a.arrow_top=a.height/2-this.config.arrow_size;break;case"top":a.top=b.top-a.height-this.config.offset-this.config.arrow_size,a.arrow_top=a.height,c=!0}switch(a.posClass[1]){case"right":c?(a.left=b.left,a.arrow_left=b.marker.width/2-this.config.arrow_size):(a.left=b.left+b.marker.width+this.config.offset+this.config.arrow_size,a.arrow_left=2*-this.config.arrow_size);break;case"center":a.left=b.left+b.marker.width/2-a.width/2,a.arrow_left=a.width/2-this.config.arrow_size;break;case"left":c?(a.left=b.left-a.width+b.marker.width,a.arrow_left=a.width-b.marker.width/2-this.config.arrow_size):(a.left=b.left-a.width-this.config.offset-this.config.arrow_size,a.arrow_left=a.width)}},h.prototype=Object.create(c.prototype),h.prototype.constructor=h,h.publicMethods=["setCaption"],h.DEFAULTS={autorotate:!0,zoom:!0,fullscreen:!0,download:!0,markers:!0},h.prototype.create=function(){c.prototype.create.call(this),this.container.className="psv-navbar",this.config.autorotate&&this.buttons.push(new j(this)),
this.config.zoom&&this.buttons.push(new l(this)),this.config.download&&this.buttons.push(new m(this)),this.config.markers&&this.buttons.push(new n(this)),this.config.fullscreen&&this.buttons.push(new k(this)),this.caption=document.createElement("div"),this.caption.className="caption",this.container.appendChild(this.caption),this.setCaption(this.psv.config.caption)},h.prototype.destroy=function(){this.buttons.forEach(function(a){a.destroy()}),this.buttons.length=0,c.prototype.destroy.call(this)},h.prototype.setCaption=function(a){a?(this.caption.style.display="block",this.caption.innerHTML=a):this.caption.style.display="none"},i.prototype.create=function(){this.button=document.createElement("div"),this.button.className="psv-button",this.navbar.container.appendChild(this.button)},i.prototype.destroy=function(){this.navbar.container.removeChild(this.button),this.navbar=null,this.psv=null,this.button=null},i.prototype.toggleActive=function(a){a?this.button.classList.add("active"):this.button.classList.remove("active")},j.prototype=Object.create(i.prototype),j.prototype.constructor=j,j.prototype.create=function(){i.prototype.create.call(this),this.button.classList.add("autorotate-button"),this.button.title=this.psv.config.lang.autorotate;var a=document.createElement("div");a.className="sphere",this.button.appendChild(a);var b=document.createElement("div");b.className="equator",this.button.appendChild(b),this.button.addEventListener("click",this.psv.toggleAutorotate.bind(this.psv)),this.psv.on("autorotate",this.toggleActive.bind(this))},k.prototype=Object.create(i.prototype),k.prototype.constructor=k,k.prototype.create=function(){i.prototype.create.call(this),this.button.classList.add("fullscreen-button"),this.button.title=this.psv.config.lang.fullscreen,this.button.appendChild(document.createElement("div")),this.button.appendChild(document.createElement("div")),this.button.addEventListener("click",this.psv.toggleFullscreen.bind(this.psv)),this.psv.on("fullscreen-updated",this)},k.prototype.destroy=function(){this.psv.off("fullscreen-updated",this),i.prototype.destroy.call(this)},k.prototype.handleEvent=function(a){switch(a.type){case"psv:fullscreen-updated":this.toggleActive()}},l.prototype=Object.create(i.prototype),l.prototype.constructor=l,l.prototype.create=function(){i.prototype.create.call(this),this.button.classList.add("zoom-button");var a=document.createElement("div");a.className="minus",a.title=this.psv.config.lang.zoomOut,a.innerHTML=b.ICONS["zoom-out.svg"],this.button.appendChild(a);var c=document.createElement("div");c.className="range",this.button.appendChild(c),this.zoom_range=document.createElement("div"),this.zoom_range.className="line",this.zoom_range.title=this.psv.config.lang.zoom,c.appendChild(this.zoom_range),this.zoom_value=document.createElement("div"),this.zoom_value.className="handle",this.zoom_value.title=this.psv.config.lang.zoom,this.zoom_range.appendChild(this.zoom_value);var d=document.createElement("div");d.className="plus",d.title=this.psv.config.lang.zoomIn,d.innerHTML=b.ICONS["zoom-in.svg"],this.button.appendChild(d),this.zoom_range.addEventListener("mousedown",this),this.zoom_range.addEventListener("touchstart",this),this.psv.container.addEventListener("mousemove",this),this.psv.container.addEventListener("touchmove",this),this.psv.container.addEventListener("mouseup",this),this.psv.container.addEventListener("touchend",this),a.addEventListener("click",this.psv.zoomOut.bind(this.psv)),d.addEventListener("click",this.psv.zoomIn.bind(this.psv)),this.psv.on("zoom-updated",this);var e=this;setTimeout(function(){e._moveZoomValue(e.psv.prop.zoom_lvl)},0)},l.prototype.destroy=function(){this.psv.container.removeEventListener("mousemove",this),this.psv.container.removeEventListener("touchmove",this),this.psv.container.removeEventListener("mouseup",this),this.psv.container.removeEventListener("touchend",this),this.psv.off("zoom-updated",this),i.prototype.destroy.call(this)},l.prototype.handleEvent=function(a){switch(a.type){case"mousedown":this._initZoomChangeWithMouse(a);break;case"touchstart":this._initZoomChangeByTouch(a);break;case"mousemove":this._changeZoomWithMouse(a);break;case"touchmove":this._changeZoomByTouch(a);break;case"mouseup":this._stopZoomChange(a);break;case"touchend":this._stopZoomChange(a);break;case"psv:zoom-updated":this._moveZoomValue(a.args[0])}},l.prototype._moveZoomValue=function(a){this.zoom_value.style.left=a/100*this.zoom_range.offsetWidth-this.zoom_value.offsetWidth/2+"px"},l.prototype._initZoomChangeWithMouse=function(a){this.prop.mousedown=!0,this._changeZoom(a.clientX)},l.prototype._initZoomChangeByTouch=function(a){this.prop.mousedown=!0,this._changeZoom(a.changedTouches[0].clientX)},l.prototype._stopZoomChange=function(a){this.prop.mousedown=!1},l.prototype._changeZoomWithMouse=function(a){a.preventDefault(),this._changeZoom(a.clientX)},l.prototype._changeZoomByTouch=function(a){a.preventDefault(),this._changeZoom(a.changedTouches[0].clientX)},l.prototype._changeZoom=function(a){if(this.prop.mousedown){var b=parseInt(a)-this.zoom_range.getBoundingClientRect().left,c=b/this.zoom_range.offsetWidth*100;this.psv.zoom(c)}},m.prototype=Object.create(i.prototype),m.prototype.constructor=m,m.prototype.create=function(){i.prototype.create.call(this),this.button.classList.add("download-button"),this.button.title=this.psv.config.lang.download,this.button.appendChild(document.createElement("div")),this.button.addEventListener("mouseenter",this.toggleActive.bind(this,!0)),this.button.addEventListener("mouseleave",this.toggleActive.bind(this,!1)),this.button.addEventListener("click",this.download.bind(this))},m.prototype.download=function(){var a=document.createElement("a");a.href=this.psv.config.panorama,a.download=this.psv.config.panorama,this.psv.container.appendChild(a),a.click()},n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.create=function(){i.prototype.create.call(this),this.button.classList.add("markers-button"),this.button.title=this.psv.config.lang.markers,this.button.innerHTML=b.ICONS["pin.svg"],this.button.addEventListener("click",this.toggleMarkers.bind(this)),this.psv.on("open-panel",this),this.psv.on("close-panel",this)},n.prototype.destroy=function(){this.psv.off("open-panel",this),this.psv.off("close-panel",this),i.prototype.destroy.call(this)},n.prototype.handleEvent=function(a){switch(a.type){case"psv:open-panel":this._onPanelOpened();break;case"psv:close-panel":this._onPanelClosed()}},n.prototype.toggleMarkers=function(){this.prop.panelOpened?this.hideMarkers():this.showMarkers()},n.prototype.showMarkers=function(){var a='<div class="psv-markers-list"><h1>'+this.psv.config.lang.markers+"</h1><ul>";for(var b in this.psv.hud.markers){var c=this.psv.hud.markers[b],d=c.id;c.html?d=c.html:c.tooltip&&(d="string"==typeof c.tooltip?c.tooltip:c.tooltip.content),a+='<li data-psv-marker="'+c.id+'">',c.image&&(a+='<img src="'+c.image+'"/>'),a+="<p>"+d+"</p></li>"}a+="</ul></div>",this.prop.panelOpening=!0,this.psv.panel.showPanel(a,!0),this.psv.panel.container.querySelector(".psv-markers-list").addEventListener("click",this._onClickItem.bind(this))},n.prototype.hideMarkers=function(){this.psv.panel.hidePanel()},n.prototype._onClickItem=function(a){var b;a.target&&(b=p.getClosest(a.target,"li"))&&b.dataset.psvMarker&&(this.psv.hud.gotoMarker(b.dataset.psvMarker,1e3),this.psv.panel.hidePanel())},n.prototype._onPanelOpened=function(){this.prop.panelOpening?(this.prop.panelOpening=!1,this.prop.panelOpened=!0):this.prop.panelOpened=!1,this.toggleActive(this.prop.panelOpened)},n.prototype._onPanelClosed=function(){this.prop.panelOpened=!1,this.prop.panelOpening=!1,this.toggleActive(this.prop.panelOpened)},o.prototype=Object.create(Error.prototype),o.prototype.name="PSVError",o.prototype.constructor=o;var p={};return p.isCanvasSupported=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))},p.isWebGLSupported=function(){var a=document.createElement("canvas");return!(!window.WebGLRenderingContext||!a.getContext("webgl"))},p.getMaxTextureWidth=function(){var a=document.createElement("canvas"),b=a.getContext("webgl");return b.getParameter(b.MAX_TEXTURE_SIZE)},p.hasParent=function(a,b){do if(a===b)return!0;while(a=a.parentNode);return!1},p.getClosest=function(a,b){var c=a.matches||a.msMatchesSelector;do if(c.bind(a)(b))return a;while(a=a.parentElement);return null},p.mouseWheelEvent=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},p.fullscreenEvent=function(){var a={exitFullscreen:"fullscreenchange",webkitExitFullscreen:"webkitfullscreenchange",mozCancelFullScreen:"mozfullscreenchange",msExitFullscreen:"msFullscreenEnabled"};for(var b in a)if(b in document)return a[b];return"fullscreenchange"},p.stayBetween=function(a,b,c){return Math.max(b,Math.min(c,a))},p.getXMPValue=function(a,b){var c,d;return-1!==(c=a.indexOf("<GPano:"+b+">"))&&-1!==(d=a.indexOf("</GPano:"+b+">"))?a.substring(c,d).replace("<GPano:"+b+">",""):-1!==(c=a.indexOf("GPano:"+b))&&-1!==(d=a.indexOf('"',c))?a.substring(c+b.length+8,d):null},p.isFullscreenEnabled=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},p.requestFullscreen=function(a){(a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen).call(a)},p.exitFullscreen=function(a){(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document)},p.getStyle=function(a,b){return window.getComputedStyle(a,null)[b]},p.parsePosition=function(a){if(!a)return{top:.5,left:.5};if("object"==typeof a)return a;var b=document.createElement("div");document.body.appendChild(b),b.style.backgroundPosition=a;var c=p.getStyle(b,"background-position").match(/^([0-9.]+)% ([0-9.]+)%$/);return document.body.removeChild(b),{left:c[1]/100,top:c[2]/100}},p.deepmerge=function(a,b){var c=Array.isArray(b),d=c&&[]||{};return c?(a=a||[],d=d.concat(a),b.forEach(function(b,c){"undefined"==typeof d[c]?d[c]=b:"object"==typeof b?d[c]=p.deepmerge(a[c],b):-1===a.indexOf(b)&&d.push(b)})):(a&&"object"==typeof a&&Object.keys(a).forEach(function(b){d[b]=a[b]}),Object.keys(b).forEach(function(c){"object"==typeof b[c]&&b[c]&&a[c]?d[c]=p.deepmerge(a[c],b[c]):d[c]=b[c]})),d},p.clone=function(a){return p.deepmerge({},a)},b.ICONS["pin.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve"><g><path d="M24,0C13.798,0,5.499,8.3,5.499,18.501c0,10.065,17.57,28.635,18.318,29.421C23.865,47.972,23.931,48,24,48   s0.135-0.028,0.183-0.078c0.748-0.786,18.318-19.355,18.318-29.421C42.501,8.3,34.202,0,24,0z M24,7.139   c5.703,0,10.342,4.64,10.342,10.343c0,5.702-4.639,10.342-10.342,10.342c-5.702,0-10.34-4.64-10.34-10.342   C13.66,11.778,18.298,7.139,24,7.139z"/></g></svg>',b.ICONS["zoom-in.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 19.407 19.407" enable-background="new 0 0 19.407 19.406" xml:space="preserve"><path d="M14.043,12.22c2.476-3.483,1.659-8.313-1.823-10.789C8.736-1.044,3.907-0.228,1.431,3.255  c-2.475,3.482-1.66,8.312,1.824,10.787c2.684,1.908,6.281,1.908,8.965,0l4.985,4.985c0.503,0.504,1.32,0.504,1.822,0  c0.505-0.503,0.505-1.319,0-1.822L14.043,12.22z M7.738,13.263c-3.053,0-5.527-2.475-5.527-5.525c0-3.053,2.475-5.527,5.527-5.527  c3.05,0,5.524,2.474,5.524,5.527C13.262,10.789,10.788,13.263,7.738,13.263z"/><polygon points="8.728,4.009 6.744,4.009 6.744,6.746 4.006,6.746 4.006,8.73 6.744,8.73 6.744,11.466 8.728,11.466 8.728,8.73   11.465,8.73 11.465,6.746 8.728,6.746 "/></svg>',b.ICONS["zoom-out.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 19.407 19.407" enable-background="new 0 0 19.407 19.406" xml:space="preserve"><path d="M14.043,12.22c2.476-3.483,1.659-8.313-1.823-10.789C8.736-1.044,3.907-0.228,1.431,3.255  c-2.475,3.482-1.66,8.312,1.824,10.787c2.684,1.908,6.281,1.908,8.965,0l4.985,4.985c0.503,0.504,1.32,0.504,1.822,0  c0.505-0.503,0.505-1.319,0-1.822L14.043,12.22z M7.738,13.263c-3.053,0-5.527-2.475-5.527-5.525c0-3.053,2.475-5.527,5.527-5.527  c3.05,0,5.524,2.474,5.524,5.527C13.262,10.789,10.788,13.263,7.738,13.263z"/><rect x="4.006" y="6.746" width="7.459" height="1.984"/></svg>',b});